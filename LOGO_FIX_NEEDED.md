# Logo Display Fix - Status

## Current Situation

The logo helper function `getLogoDataURI()` has been added to `server/routes/export.ts`, but the branding HTML that uses it was removed by the autofix.

## What's Missing

### 1. Page-Specific Export (Full Analysis from Action Plan Modal)

The `generatePageSpecificHTML()` function needs to be added back with branding:

```typescript
function generatePageSpecificHTML(result: any, selectedPages: string[], options: any): string {
  const logoDataURI = getLogoDataURI();
  const showBranding = options.customization?.showBranding !== false;
  
  // Add logo in header
  ${showBranding ? `
    <div class="branding-header">
      <img src="${logoDataURI}" alt="Unbuilt Logo" style="height: 40px;" />
      <div class="url">unbuilt.one</div>
    </div>
  ` : ''}
  
  // Add logo in footer
  ${showBranding ? `
    <div class="footer-branding">
      <img src="${logoDataURI}" alt="Unbuilt Logo" style="height: 30px;" />
      <div>Generated by Unbuilt - unbuilt.one</div>
    </div>
  ` : ''}
}
```

### 2. Multi-Result Export (Search Results List)

The PDF generator service needs to be updated to include branding. This is in `server/services/pdf-generator.ts`.

Add logo to the HTML generation:

```typescript
generateHTML(results: SearchResult[], options: PDFOptions): string {
  const logoDataURI = getLogoDataURI(); // Import from export.ts or duplicate function
  const showBranding = options.showBranding !== false;
  
  // Header with logo
  if (showBranding) {
    html += `
      <div style="display: flex; justify-content: space-between; padding: 20px; border-bottom: 2px solid #e5e7eb;">
        <img src="${logoDataURI}" alt="Unbuilt" style="height: 40px;" />
        <div style="color: #7c3aed; font-weight: 600;">unbuilt.one</div>
      </div>
    `;
  }
  
  // Footer with logo
  if (showBranding) {
    html += `
      <div style="display: flex; justify-content: space-between; padding: 20px; border-top: 2px solid #e5e7eb; margin-top: 50px;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <img src="${logoDataURI}" alt="Unbuilt" style="height: 30px;" />
          <div>
            <div style="font-weight: 600;">Generated by Unbuilt</div>
            <div style="font-size: 11px;">unbuilt.one - AI-Powered Market Gap Analysis</div>
          </div>
        </div>
        <div style="text-align: right; color: #6b7280; font-size: 12px;">
          <div>${date}</div>
          <div>Confidential</div>
        </div>
      </div>
    `;
  }
}
```

## Quick Fix Steps

1. **Add the page-specific HTML generator back** to `server/routes/export.ts`
2. **Update the PDF generator** in `server/services/pdf-generator.ts` to include branding
3. **Test both exports**:
   - Export from search results list (multi-result)
   - Export from action plan modal (single result with page selection)

## Why Logo Wasn't Showing

The logo wasn't displaying because:
1. External URLs (`https://unbuilt.one/assets/logo.gif`) don't work in Puppeteer PDFs
2. The logo needs to be embedded as a base64 data URI
3. The `getLogoDataURI()` function solves this by reading the file and converting it

## Files That Need Updates

1. `server/routes/export.ts` - Add `generatePageSpecificHTML()` with branding
2. `server/services/pdf-generator.ts` - Add branding to multi-result exports
3. Both need to use `getLogoDataURI()` for embedded logos

## Expected Result

**Multi-Result Export (Search Results List):**
```
┌─────────────────────────────────────┐
│ [Logo]              unbuilt.one     │
├─────────────────────────────────────┤
│                                     │
│   Market Gap Analysis Report        │
│                                     │
│   7 Opportunities Found             │
│   Combined Market Size: $99B        │
│                                     │
│   [List of opportunities...]        │
│                                     │
├─────────────────────────────────────┤
│ [Logo] Generated by Unbuilt   Date │
│        unbuilt.one         Company  │
└─────────────────────────────────────┘
```

**Single-Result Export (Full Analysis):**
```
┌─────────────────────────────────────┐
│ [Logo]              unbuilt.one     │
├─────────────────────────────────────┤
│                                     │
│   AI-Generated Custom Educational   │
│   Content for Niche Skills          │
│                                     │
│   [Selected pages content...]       │
│   - Full Analysis                   │
│   - Development Roadmap             │
│   - etc.                            │
│                                     │
├─────────────────────────────────────┤
│ [Logo] Generated by Unbuilt   Date │
│        unbuilt.one         Company  │
└─────────────────────────────────────┘
```

## Alternative: Simple Text Branding

If the logo continues to cause issues, use simple text branding:

```typescript
// Header
<div style="text-align: center; padding: 20px; border-bottom: 2px solid #7c3aed;">
  <h1 style="color: #7c3aed; margin: 0;">UNBUILT</h1>
  <div style="color: #6b7280;">unbuilt.one - AI-Powered Market Gap Analysis</div>
</div>

// Footer
<div style="text-align: center; padding: 20px; border-top: 2px solid #e5e7eb; color: #6b7280; font-size: 12px;">
  <div>Generated by Unbuilt (unbuilt.one)</div>
  <div>${date} | Confidential</div>
</div>
```

This would work immediately without any image loading issues.
